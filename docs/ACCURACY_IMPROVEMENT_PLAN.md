# 精度向上計画

## 🎯 現在の問題点と解決策

### 問題1: 事前学習済み重みを使っていない
**現在**: `weights=None`（ランダム初期化）
**改善**: `weights='imagenet'`（ImageNetの事前学習済み重み）

**効果**: **+10-15%の精度向上が期待できる**

### 問題2: データ拡張が強すぎる
**現在**: 
- rotation_range: 30-45度
- width_shift_range: 0.2-0.3
- brightness_range: [0.8, 1.2]

**改善**: 
- rotation_range: 15度
- width_shift_range: 0.1
- brightness_range: [0.9, 1.1]

**効果**: 訓練精度が上がり、適切に学習できる

### 問題3: Dropoutが高すぎる
**現在**: `dropout_rate: 0.5`（50%を無効化）
**改善**: `dropout_rate: 0.3`（30%に減らす）

**効果**: 学習能力が向上

### 問題4: クラス不均衡
**現在**: good: 1144枚、欠陥: 88-117枚
**改善**: より強いクラス重みを適用

**効果**: 欠陥検出精度が向上

---

## 📋 実装順序（優先度順）

### ステップ1: 即座に適用できる改善（10分）

1. **事前学習済み重みの使用**
   - `weights=None` → `weights='imagenet'`
   - 最も効果が大きい

2. **データ拡張の弱化**
   - 設定値を調整

3. **Dropoutの削減**
   - 0.5 → 0.3

**期待効果**: **+15-25%の精度向上**

---

### ステップ2: クラス不均衡対策（30分）

1. **クラス重みの強化**
2. **少数派クラスのデータ拡張を強化**

**期待効果**: **+5-10%の精度向上**

---

### ステップ3: データ追加（数日）

1. **少数派クラスのデータ収集**
   - black_spot: 88枚 → 200枚以上
   - chipping: 117枚 → 200枚以上
   - scratch: 112枚 → 200枚以上

**期待効果**: **+5-10%の精度向上**

---

### ステップ4: 高度な手法（数週間）

1. **Focal Lossの導入**
2. **テスト時拡張（TTA）**
3. **アーキテクチャの改善**

**期待効果**: **+3-8%の精度向上**

---

## ✅ 次のアクション

**すぐに実装できます**:

1. **既存スクリプトを修正**して、上記の改善を適用
2. **新しい最適化版スクリプト**を作成（`train_4class_optimized.py`）

どちらにしますか？




















