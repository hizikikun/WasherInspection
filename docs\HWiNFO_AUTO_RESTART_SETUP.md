# HWiNFO自動再起動システム設定ガイド

HWiNFOのShared Memory機能は、無料版では12時間後に自動的にオフになる制限があります。この制限を回避するために、12時間ごとにHWiNFOを自動的に再起動するシステムを設定します。

## 📋 前提条件

- HWiNFO64がインストールされていること
- HWiNFOの設定で「Shared Memory Support」が有効になっていること
  - HWiNFO → Settings → General / User Interface → 「Shared Memory Support」にチェック

## 🚀 セットアップ方法

### 方法1: 自動セットアップ（推奨）

1. **セットアップスクリプトを実行**
   ```cmd
   cd scripts
   setup_hwinfo_scheduler.bat
   ```

2. **タスクスケジューラで詳細設定を確認**
   - タスクスケジューラを開く（スタートメニューで「タスク」と検索）
   - 「HWiNFO_AutoRestart」タスクを選択
   - 「トリガー」タブを開く
   - トリガーを選択して「編集」をクリック
   - 以下の設定を確認テ変更：
     - **繰り返し間隔**: 12時間（または11時間に設定して余裕を持たせる）
     - **継続時間**: 無期限
     - **有効**: チェックを入れる

### 方法2: 手動セットアップ

#### ステップ1: タスクスケジューラを開く

1. スタートメニューで「タスク」と検索
2. 「タスクスケジューラ」を開く

#### ステップ2: 新しいタスクを作成

1. 右側の「タスクの作成」をクリック
2. **全般**タブ:
   - 名前: `HWiNFO_AutoRestart`
   - 「最上位の特権で実行する」にチェック
   - 「ユーザーがログオンしているかどうかにかかわらず実行する」を選択
   - 「非表示」にチェック（オプション）

3. **トリガー**タブ:
   - 「新規」ボタンをクリック
   - **タスクの開始**: 「ログオン時」を選択
   - **詳細設定**:
     - 「タスクを繰り返す」にチェック
     - **繰り返し間隔**: 12時間（または11時間）
     - **継続時間**: 無期限
     - 「有効」にチェック

4. **操作**タブ:
   - 「新規」ボタンをクリック
   - **操作**: 「プログラムの開始」
   - **プログラム/スクリプト**: 
     ```
     C:\Users\tomoh\AppData\Local\Programs\Python\Python310\python.exe
     ```
   - **引数の追加**:
     ```
     "C:\Users\tomoh\WasherInspection\scripts\hwinfo_auto_restart.py" restart
     ```
   - **開始場所**:
     ```
     C:\Users\tomoh\WasherInspection\scripts
     ```

5. **条件**タブ:
   - 「コンピューターをAC電源で使用している場合にのみタスクを開始する」のチェックを外ム（デスクトップの場合）

6. **設定**タブ:
   - 「要求時にタスクをムぐに実行する」にチェック
   - 「タスクが要求されたときに実行できなかった場合は、できるだけ早く実行する」にチェック
   - 「実行しているタスクを停止するには、次の時間を超えない」はデフォルトのまま

7. **OK**をクリックして保存

## ✅ 動作確認

### テスト実行

1. コマンドプロンプトで以下を実行：
   ```cmd
   cd C:\Users\tomoh\WasherInspection\scripts
   python hwinfo_auto_restart.py restart
   ```

2. HWiNFOが再起動されることを確認

### タスクスケジューラの確認

1. タスクスケジューラを開く
2. 「HWiNFO_AutoRestart」タスクを確認
3. 「履歴」タブで実行履歴を確認

## 🔧 トラブルシューティング

### HWiNFO64.exeが見つからない

`hwinfo_auto_restart.py`を編集して、HWiNFO64.exeの正しいパスを指定してください：

```python
possible_paths = [
    r"C:\Program Files\HWiNFO64\HWiNFO64.EXE",  # 通常のインストール場所
    r"C:\Program Files (x86)\HWiNFO64\HWiNFO64.EXE",  # 32bit版の場合
    r"実際のパス\HWiNFO64.EXE",  # カスタムインストール場所
]
```

### タスクが実行されない

1. タスクスケジューラの「履歴」タブでエラーを確認
2. タスクの「実行」を右クリックして「実行」で手動実行を試み
3. Pythonスクリプトのパスが正しいか確認
4. 管理者権限が必要な場合、タスクスケジューラを管理者として実行

### 12時間の制限を確実に回避する

参考情報によると、11時間間隔で再起動することで、12時間制限を確実に回避できまム。設定を11時間に変更することを推奨します。

## 📝 参考情報

- [HWiNFO制限回避の詳細手順](https://diary.d-yoshi.com/%E3%80%90hwinfo%E3%80%91%E5%88%B6%E9%99%90%E5%9B%9E%E9%81%BF/)
- HWiNFO公式ドキュメント

## 🔄 更新履歴

- 2024年: 初版作成（12時間ごとの自動再起動システム）

